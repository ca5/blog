<!DOCTYPE html>
<html lang="jp">
<head>
        <meta charset="utf-8" />
        <title>Android端末と Debian kitと PyAudio</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="ca5blog Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">ca5blog </a></h1>
                <nav><ul>
                    <li><a href="/category/8bit-game.html">8bit, game</a></li>
                    <li><a href="/category/8bit-game-music.html">8bit, game, music</a></li>
                    <li><a href="/category/8bit-music.html">8bit, music</a></li>
                    <li><a href="/category/8bit-music-ri-ji.html">8bit, music, 日記</a></li>
                    <li><a href="/category/8bit-music-web.html">8bit, music, web</a></li>
                    <li><a href="/category/8bit-tumblr.html">8bit, tumblr</a></li>
                    <li><a href="/category/art-music.html">art, music</a></li>
                    <li><a href="/category/art-music-ri-ji-shi-bewu.html">art, music, 日記, 食べ物</a></li>
                    <li><a href="/category/game.html">game</a></li>
                    <li><a href="/category/game-music.html">game, music</a></li>
                    <li><a href="/category/game-music-video-web.html">game, music, video, web</a></li>
                    <li><a href="/category/game-web.html">game, web</a></li>
                    <li><a href="/category/game-wu-yu.html">game, 物欲</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                    <li class="active"><a href="/category/music.html">music</a></li>
                    <li><a href="/category/music-neta.html">music, ネタ</a></li>
                    <li><a href="/category/music-ri-ji.html">music, 日記</a></li>
                    <li><a href="/category/music-tumblr-video.html">music, tumblr, video</a></li>
                    <li><a href="/category/music-tumblr-video-neta.html">music, tumblr, video, ネタ</a></li>
                    <li><a href="/category/music-video.html">music, video</a></li>
                    <li><a href="/category/music-video-neta-wu-yu.html">music, video, ネタ, 物欲</a></li>
                    <li><a href="/category/music-video-web.html">music, video, web</a></li>
                    <li><a href="/category/music-web.html">music, web</a></li>
                    <li><a href="/category/music-wei-fen-lei.html">music, 未分類</a></li>
                    <li><a href="/category/ri-ji.html">日記</a></li>
                    <li><a href="/category/shi-bewu.html">食べ物</a></li>
                    <li><a href="/category/sonota.html">その他</a></li>
                    <li><a href="/category/sonota-ri-ji.html">その他, 日記</a></li>
                    <li><a href="/category/sonota-wu-yu.html">その他, 物欲</a></li>
                    <li><a href="/category/tumblr.html">tumblr</a></li>
                    <li><a href="/category/tumblr-video-neta-wu-yu.html">tumblr, video, ネタ, 物欲</a></li>
                    <li><a href="/category/tumblr-web.html">tumblr, web</a></li>
                    <li><a href="/category/video.html">video</a></li>
                    <li><a href="/category/video-neta.html">video, ネタ</a></li>
                    <li><a href="/category/video-web.html">video, web</a></li>
                    <li><a href="/category/video-web-neta.html">video, web, ネタ</a></li>
                    <li><a href="/category/video-web-ri-ji.html">video, web, 日記</a></li>
                    <li><a href="/category/video-wu-yu.html">video, 物欲</a></li>
                    <li><a href="/category/web.html">web</a></li>
                    <li><a href="/category/web-ri-ji.html">web, 日記</a></li>
                    <li><a href="/category/web-sonota.html">web, その他</a></li>
                    <li><a href="/category/web-sonota-neta.html">web, その他, ネタ</a></li>
                    <li><a href="/category/web-wu-yu.html">web, 物欲</a></li>
                    <li><a href="/category/wei-fen-lei.html">未分類</a></li>
                    <li><a href="/category/wu-yu.html">物欲</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/androiddebian-kit-pyaudio.html" rel="bookmark"
           title="Permalink to Android端末と Debian kitと PyAudio">Android端末と Debian kitと PyAudio</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-05-04T22:30:00+02:00">
                Published: 日 04 5月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/admin.html">admin</a>
        </address>
<p>In <a href="/category/music.html">music</a>. </p>
<p>tags: <a href="/tag/android.html">android</a> <a href="/tag/debian.html">debian</a> <a href="/tag/pyaudio.html">PyAudio</a> <a href="/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->      <p>家に使ってないAndroid端末があったんで、<br />
Debian化してpython入れて音出せるかどうか試してみました。<br />
結論から言うと全然うまくいかないんですが。</p>
<p>対象端末:<br />
・Galaxy Tab(SC-01C)<br />
→ 中古で購入した時点ですでに JK2 FroyoのRoot化ROMが焼いてあったっぽい<br />
　→ バージョンは2.2 Froyo</p>
<h2>Debianのinstall</h2>
<p>この記事を参考に、Debian kitを使ってDebianを入れます<br />
<a href="http://gihyo.jp/admin/serial/01/ubuntu-recipe/0256?page=3">http://gihyo.jp/admin/serial/01/ubuntu-recipe/0256?page=3<br />
</a><br />
Debian入れると言っても完全にOS焼きなおすんじゃなくて、<br />
chrootな環境が出来上がるだけってもののようです。</p>
<p>基本的にはAndroid端末にDebian
kitと何か端末シミュレータをいれて上記の記事にそってインストールしていっただけ。  </p>
<p>OSが入って、debコマンドで環境起動したら、その後の作業が楽になるようにssh
serverを入れておきます</p>
<p>[bash]<br />
apt-get install openssh-server<br />
[/bash]</p>
<p>その後の作業は外部からこの端末にsshして色々いじっていく</p>
<h2>pythonとかpyenvとか</h2>
<p>pyenv入れる前に以下をapt-get installしておく<br />
参考：<a href="https://github.com/yyuu/pyenv/wiki/Common-build-problems">https://github.com/yyuu/pyenv/wiki/Common-build-problems<br />
</a><br />
[bash]<br />
git<br />
make<br />
build-essential<br />
libssl-dev<br />
zlib1g-dev<br />
libbz2-dev<br />
libreadline-dev<br />
libsqlite3-dev<br />
wget<br />
curl<br />
llvm<br />
[/bash]</p>
<p>pyenvをレポジトリのREADMEに沿ってインストール<br />
<a href="https://github.com/yyuu/pyenv">https://github.com/yyuu/pyenv</a></p>
<p>pythonのインストールと環境設定<br />
[bash]<br />
pyenv install 2.7.6<br />
pyenv local 2.7.6<br />
[/bash]</p>
<h2>PyAudioとportaudio</h2>
<p>PyAudioはportaudioのpython wrapper版<br />
http://people.csail.mit.edu/hubert/pyaudio/</p>
<p>portaudioは各OSのaudio apiをwrapしたAPI<br />
http://portaudio.com/docs/v19-doxydocs/api_overview.html</p>
<p>PyAudio入れる前に、aptでportaudio v19を入れておく<br />
[bash]<br />
portaudio19-dev<br />
libportaudio-dev<br />
[/bash]</p>
<p>PyAudioのインストール<br />
[bash]<br />
pip install --allow-external PyAudio --allow-unverified PyAudio
PyAudio<br />
[/bash]<br />
この長ったらしいオプション指定なんとかならんのか。。</p>
<h2>動作チェック</h2>
<p>PyAudio本家のサンプルをそのままコピって動かしてみる<br />
http://people.csail.mit.edu/hubert/pyaudio/</p>
<p>[python]<br />
"""PyAudio Example: Play a WAVE file."""</p>
<p>import pyaudio<br />
import wave<br />
import sys</p>
<p>CHUNK = 1024</p>
<p>if len(sys.argv) \&lt; 2:<br />
print("Plays a wave file.\n\nUsage: %s filename.wav" % sys.argv[0])<br />
sys.exit(-1)</p>
<p>wf = wave.open(sys.argv[1], 'rb')</p>
<p>p = pyaudio.PyAudio()</p>
<p>stream = p.open(format=p.get_format_from_width(wf.getsampwidth()),<br />
channels=wf.getnchannels(),<br />
rate=wf.getframerate(),<br />
output=True)</p>
<p>data = wf.readframes(CHUNK)</p>
<p>while data != '':<br />
stream.write(data)<br />
data = wf.readframes(CHUNK)</p>
<p>stream.stop_stream()<br />
stream.close()</p>
<p>p.terminate()<br />
[/python]</p>
<p>実行<br />
[bash]<br />
\$ python ./soundtest.py amen.wav<br />
Traceback (most recent call last):<br />
File "./soundtest.py", line 22, in \&lt;module><br />
output=True)<br />
File
"/home/ca5/.pyenv/versions/2.7.6/lib/python2.7/site-packages/pyaudio.py",
line 747, in open<br />
stream = Stream(self, *args, **kwargs)<br />
File
"/home/ca5/.pyenv/versions/2.7.6/lib/python2.7/site-packages/pyaudio.py",
line 442, in __init__<br />
self._stream = pa.open(**arguments)<br />
IOError: [Errno Invalid output device (no default output
device)] -9996<br />
[/bash]</p>
<p>わー　デバイスが認識されてねー</p>
<p>別途、portaudioのサンプルも動かしてみたんですがやっぱりダメ<br />
portaudioが使うaudioAPIが対応してないと思われる。</p>
<p>Android側のバージョンあげたらportaudioが使えるってどこかの記事で見かけたんで<br />
次はOS上げて再チャレンジか</p>
<h2>参考</h2>
<p>http://stackoverflow.com/questions/5921947/pyaudio-installation-error-command-gcc-failed-with-exit-status-1</p>
<p>ここ見るとportaudioでOpenSL使えそう？<br />
http://www.gizmodo.jp/2012/07/android_osjelly_bean.html</p>
<p>http://stackoverflow.com/questions/4672155/pyaudio-ioerror-no-default-input-device-available</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>